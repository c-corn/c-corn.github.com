<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>CoRN.reals.fast.Plot</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<div class="code">

<br/>
<span class="id" type="keyword">Section</span> <span class="id" type="section"><a name="Plot">Plot</a></span>.<br/>
</div>

<div class="doc">
<a name="lab729"></a><h1 class="section">Plotting</h1>

Plotting a uniformly continuous function on a finite interval consists
of producing the graph of a function as a compact set, approximating that
graph, and finally rasterizing that approximation.

<br/><br/>
A range for the plot must be provided.  We choose to clamp the plotted
function so that it lies inside the specified range.  Thus we plot
<span class="inlinecode"><span class="id" type="var">compose</span> (<span class="id" type="var">clip</span> <span class="id" type="var">b</span> <span class="id" type="var">t</span>) <span class="id" type="var">f</span></span> rather than <span class="inlinecode"><span class="id" type="var">f</span></span>.

</div>
<div class="code">
<span class="id" type="keyword">Variable</span> (<span class="id" type="variable"><a name="Plot.l">l</a></span> <span class="id" type="variable"><a name="Plot.r">r</a></span>:Q).<br/>
<span class="id" type="keyword">Hypothesis</span> <span class="id" type="variable"><a name="Plot.Hlr">Hlr</a></span> : <span class="id" type="var">l</span> &lt; <span class="id" type="var">r</span>.<br/>

<br/>
<span class="id" type="keyword">Variable</span> (<span class="id" type="variable"><a name="Plot.b">b</a></span> <span class="id" type="variable"><a name="Plot.t">t</a></span>:Q).<br/>
<span class="id" type="keyword">Hypothesis</span> <span class="id" type="variable"><a name="Plot.Hbt">Hbt</a></span> : <span class="id" type="var">b</span> &lt; <span class="id" type="var">t</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Let</span> <span class="id" type="definition"><a name="clip">clip</a></span> := <span class="id" type="definition"><a class="idref" href="CoRN.metric2.UniformContinuity.html#uc_compose">uc_compose</a></span> (<span class="id" type="definition"><a class="idref" href="CoRN.reals.fast.CRGroupOps.html#boundBelow">boundBelow</a></span> <span class="id" type="var">b</span>) (<span class="id" type="definition"><a class="idref" href="CoRN.reals.fast.CRGroupOps.html#boundAbove">boundAbove</a></span> <span class="id" type="var">t</span>).<br/>

<br/>
<span class="id" type="keyword">Variable</span> <span class="id" type="variable"><a name="Plot.f">f</a></span> : <span class="id" type="definition"><a class="idref" href="CoRN.model.metric2.Qmetric.html#Q_as_MetricSpace">Q_as_MetricSpace</a></span> --&gt; <span class="id" type="definition"><a class="idref" href="CoRN.model.metric2.CRmetric.html#CR">CR</a></span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="lemma"><a name="plFEQ">plFEQ</a></span> : <span class="id" type="definition"><a class="idref" href="CoRN.metric2.Prelength.html#PrelengthSpace">PrelengthSpace</a></span> (<span class="id" type="definition"><a class="idref" href="CoRN.metric2.FinEnum.html#FinEnum">FinEnum</a></span> <span class="id" type="lemma"><a class="idref" href="CoRN.model.metric2.Qmetric.html#stableQ">stableQ</a></span>).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="definition"><a name="graphQ">graphQ</a></span> <span class="id" type="var">f</span> := <span class="id" type="definition"><a class="idref" href="CoRN.metric2.Graph.html#CompactGraph_b">CompactGraph_b</a></span> <span class="id" type="var">f</span> <span class="id" type="lemma"><a class="idref" href="CoRN.reals.fast.RasterQ.html#stableQ2">stableQ2</a></span> <span class="id" type="lemma"><a class="idref" href="CoRN.reals.fast.Plot.html#plFEQ">plFEQ</a></span> (<span class="id" type="definition"><a class="idref" href="CoRN.reals.fast.Interval.html#CompactIntervalQ">CompactIntervalQ</a></span> (<span class="id" type="lemma"><a class="idref" href="http://coq.inria.fr/library/Coq.QArith.QArith_base.html#Qlt_le_weak">Qlt_le_weak</a></span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">Hlr</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="lemma"><a name="graphQ_bonus">graphQ_bonus</a></span> : <span class="id" type="keyword">forall</span> <span class="id" type="var">e</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <br/>
&nbsp;<span class="id" type="definition"><a class="idref" href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id" type="var">x</span>, <span class="id" type="var">y</span>) (<span class="id" type="projection"><a class="idref" href="CoRN.metric2.Complete.html#approximate">approximate</a></span> (<span class="id" type="definition"><a class="idref" href="CoRN.reals.fast.Plot.html#graphQ">graphQ</a></span> (<span class="id" type="definition"><a class="idref" href="CoRN.metric2.UniformContinuity.html#uc_compose">uc_compose</a></span> <span class="id" type="var">clip</span> <span class="id" type="var">f</span>)) <span class="id" type="var">e</span>) -&gt; <span class="id" type="var">l</span> &lt;= <span class="id" type="var">x</span> &lt;= <span class="id" type="var">r</span> /\ <span class="id" type="var">b</span> &lt;= <span class="id" type="var">y</span> &lt;= <span class="id" type="var">t</span>.<br/>

<br/>
<span class="id" type="keyword">Variable</span> <span class="id" type="variable"><a name="Plot.n">n</a></span> <span class="id" type="variable"><a name="Plot.m">m</a></span> : <b>N</b>.<br/>
<span class="id" type="keyword">Hypothesis</span> <span class="id" type="variable"><a name="Plot.Hn">Hn</a></span> : <span class="id" type="definition"><a class="idref" href="CoRN.tactics.AlgReflection.html#eq_nat">eq_nat</a></span> <span class="id" type="var">n</span> 0 = <span class="id" type="constructor"><a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<span class="id" type="keyword">Hypothesis</span> <span class="id" type="variable"><a name="Plot.Hm">Hm</a></span> : <span class="id" type="definition"><a class="idref" href="CoRN.tactics.AlgReflection.html#eq_nat">eq_nat</a></span> <span class="id" type="var">m</span> 0 = <span class="id" type="constructor"><a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>

<br/>
<span class="id" type="keyword">Let</span> <span class="id" type="definition"><a name="w">w</a></span> := <span class="id" type="definition"><a class="idref" href="CoRN.logic.CLogic.html#proj1_sigT">proj1_sigT</a></span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="lemma"><a class="idref" href="CoRN.model.structures.Qpossec.html#Qpos_lt_plus">Qpos_lt_plus</a></span> <span class="id" type="var">Hlr</span>).<br/>
<span class="id" type="keyword">Let</span> <span class="id" type="definition"><a name="h">h</a></span> := <span class="id" type="definition"><a class="idref" href="CoRN.logic.CLogic.html#proj1_sigT">proj1_sigT</a></span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="lemma"><a class="idref" href="CoRN.model.structures.Qpossec.html#Qpos_lt_plus">Qpos_lt_plus</a></span> <span class="id" type="var">Hbt</span>).<br/>

<br/>
<span class="id" type="keyword">Let</span> <span class="id" type="definition"><a name="err">err</a></span> := <span class="id" type="definition"><a class="idref" href="CoRN.model.totalorder.QposMinMax.html#Qpos_max">Qpos_max</a></span> ((1 # 4 * <span class="id" type="definition"><a class="idref" href="http://coq.inria.fr/library/Coq.NArith.BinPos.html#P_of_succ_nat">P_of_succ_nat</a></span> (<span class="id" type="definition"><a class="idref" href="http://coq.inria.fr/library/Coq.Init.Peano.html#pred">pred</a></span> <span class="id" type="var">n</span>)) * <span class="id" type="var">w</span>) <br/>
&nbsp;((1 # 4 * <span class="id" type="definition"><a class="idref" href="http://coq.inria.fr/library/Coq.NArith.BinPos.html#P_of_succ_nat">P_of_succ_nat</a></span> (<span class="id" type="definition"><a class="idref" href="http://coq.inria.fr/library/Coq.Init.Peano.html#pred">pred</a></span> <span class="id" type="var">m</span>)) * <span class="id" type="var">h</span>).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" type="var">PlotQ</span></span> is the function that does all the work. 
</div>
<div class="code">
<span class="id" type="keyword">Definition</span> <span class="id" type="definition"><a name="PlotQ">PlotQ</a></span> := <span class="id" type="definition"><a class="idref" href="CoRN.reals.fast.RasterizeQ.html#RasterizeQ2">RasterizeQ2</a></span> (<span class="id" type="projection"><a class="idref" href="CoRN.metric2.Complete.html#approximate">approximate</a></span> (<span class="id" type="definition"><a class="idref" href="CoRN.reals.fast.Plot.html#graphQ">graphQ</a></span> (<span class="id" type="definition"><a class="idref" href="CoRN.metric2.UniformContinuity.html#uc_compose">uc_compose</a></span> <span class="id" type="var">clip</span> <span class="id" type="var">f</span>)) <span class="id" type="var">err</span>) <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">t</span> <span class="id" type="var">l</span> <span class="id" type="var">b</span> <span class="id" type="var">r</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
The resulting plot is close to the graph of <span class="inlinecode"><span class="id" type="var">f</span></span> 
</div>
<div class="code">
<span class="id" type="keyword">Theorem</span> <span class="id" type="lemma"><a name="Plot_correct">Plot_correct</a></span> : <br/>
<span class="id" type="var">ball</span> (<span class="id" type="var">err</span> + <span class="id" type="definition"><a class="idref" href="CoRN.model.totalorder.QposMinMax.html#Qpos_max">Qpos_max</a></span> ((1 # 2 * <span class="id" type="definition"><a class="idref" href="http://coq.inria.fr/library/Coq.NArith.BinPos.html#P_of_succ_nat">P_of_succ_nat</a></span> (<span class="id" type="definition"><a class="idref" href="http://coq.inria.fr/library/Coq.Init.Peano.html#pred">pred</a></span> <span class="id" type="var">n</span>)) * <span class="id" type="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((1 # 2 * <span class="id" type="definition"><a class="idref" href="http://coq.inria.fr/library/Coq.NArith.BinPos.html#P_of_succ_nat">P_of_succ_nat</a></span> (<span class="id" type="definition"><a class="idref" href="http://coq.inria.fr/library/Coq.Init.Peano.html#pred">pred</a></span> <span class="id" type="var">m</span>)) * <span class="id" type="var">h</span>))<br/>
&nbsp;(<span class="id" type="definition"><a class="idref" href="CoRN.reals.fast.Plot.html#graphQ">graphQ</a></span> (<span class="id" type="definition"><a class="idref" href="CoRN.metric2.UniformContinuity.html#uc_compose">uc_compose</a></span> <span class="id" type="var">clip</span> <span class="id" type="var">f</span>))<br/>
&nbsp;(<span class="id" type="definition"><a class="idref" href="CoRN.metric2.Complete.html#Cunit">Cunit</a></span> (<span class="id" type="definition"><a class="idref" href="CoRN.reals.fast.RasterQ.html#InterpRaster">InterpRaster</a></span> <span class="id" type="definition"><a class="idref" href="CoRN.reals.fast.Plot.html#PlotQ">PlotQ</a></span> (<span class="id" type="var">l</span>,t) (<span class="id" type="var">r</span>,b))).<br/>

<br/>
<span class="id" type="keyword">End</span> <span class="id" type="section"><a class="idref" href="CoRN.reals.fast.Plot.html#Plot">Plot</a></span>.<br/>

<br/>
</div>

<div class="doc">
Some nice notation for the graph of f. 
</div>
<div class="code">
<span class="id" type="keyword">Notation</span> "'graphCR' f [ l '..' r ]" := <br/>
&nbsp;(<span class="id" type="definition"><a class="idref" href="CoRN.reals.fast.Plot.html#graphQ">graphQ</a></span> <span class="id" type="var">l</span> <span class="id" type="var">r</span> (<span class="id" type="constructor"><a class="idref" href="http://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span> <span class="id" type="var">_</span>) <span class="id" type="var">f</span>) (<span class="id" type="var">f</span> <span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 0) : <span class="id" type="var">raster</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr">coqdoc</a>
</div>

</div>

</body>
</html>